<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title>Mapa Inteligente SUS - DRS VI</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Bibliotecas Externas -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- ESTILOS MODERNOS (UI/UX) --- */
        :root {
            --primary: #0056b3;
            --secondary: #00a8cc;
            --accent: #ff4757;
            --dark: #2f3542;
            --light: #f1f2f6;
            --glass: rgba(255, 255, 255, 0.92);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        body { 
            margin: 0; 
            font-family: 'Roboto', sans-serif; 
            background-color: var(--light); 
            overflow: hidden;
        }

        #map { 
            width: 100%; 
            height: 100vh; 
            z-index: 1; 
        }

        /* --- PAINÉIS FLUTUANTES (Glassmorphism) --- */
        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: var(--shadow);
            padding: 15px;
            transition: all 0.3s ease;
        }

        /* Menu de Controle */
        #control-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            width: 280px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .panel-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary);
            margin: 0 0 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Input de Busca */
        .search-box {
            position: relative;
        }
        .search-input {
            width: 100%;
            padding: 10px 35px 10px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
            transition: border-color 0.2s;
        }
        .search-input:focus {
            border-color: var(--primary);
        }
        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        /* Botões de Modo (Radio Personalizado) */
        .mode-selector {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .mode-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.2s;
        }
        .mode-option:hover {
            background: rgba(0, 86, 179, 0.1);
        }
        .mode-option input {
            margin-right: 10px;
            accent-color: var(--primary);
            width: 16px;
            height: 16px;
        }
        .mode-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--dark);
        }

        /* --- INFO BOX LATERAL --- */
        #info-sidebar {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            width: 340px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            transform: translateX(120%); /* Escondido por padrão */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #info-sidebar.active {
            transform: translateX(0);
        }

        .info-header {
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        .info-header h2 {
            margin: 0;
            color: var(--primary);
            font-size: 22px;
        }
        .info-header span {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Cards de Dados */
        .data-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .data-card h4 {
            margin: 0 0 8px 0;
            font-size: 13px;
            color: #777;
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
            border-bottom: 1px dotted #eee;
        }
        .stat-row:last-child { border-bottom: none; }
        .stat-label { font-size: 13px; color: var(--dark); }
        .stat-value { font-weight: 700; color: var(--primary); }
        
        .big-number {
            font-size: 28px;
            font-weight: 700;
            color: var(--accent);
            text-align: center;
            display: block;
            margin: 5px 0;
        }

        /* --- TOOLTIPS INTELIGENTES --- */
        .smart-tooltip {
            background: rgba(0, 0, 0, 0.8);
            border: none;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            font-size: 12px;
            padding: 5px 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .leaflet-tooltip-left:before, .leaflet-tooltip-right:before {
            border-left-color: rgba(0,0,0,0.8);
            border-right-color: rgba(0,0,0,0.8);
        }

        /* Loading */
        #loading {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 15px;
            color: var(--primary);
            font-weight: bold;
        }
        .spinner {
            width: 40px; height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Botão Ação */
        .btn-action {
            background: var(--primary);
            color: white;
            border: none;
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: background 0.2s;
        }
        .btn-action:hover { background: #004494; }

    </style>
</head>
<body>

    <div id="loading">
        <div class="spinner"></div>
        <div>Carregando inteligência de dados...</div>
    </div>

    <div id="map"></div>

    <!-- Painel de Controle Esquerdo -->
    <div id="control-panel" class="glass-panel">
        <div class="panel-title"><i class="fas fa-map-marked-alt"></i> Controle DRS VI</div>
        
        <!-- Busca Inteligente -->
        <div class="search-box">
            <input type="text" id="city-search" class="search-input" placeholder="Buscar município..." list="city-list">
            <i class="fas fa-search search-icon"></i>
            <datalist id="city-list"></datalist>
        </div>

        <div style="border-top: 1px solid rgba(0,0,0,0.1); margin: 5px 0;"></div>

        <div class="mode-selector">
            <div class="panel-title" style="font-size: 13px; color: #666;">MODO DE VISUALIZAÇÃO</div>
            <label class="mode-option">
                <input type="radio" name="modo" value="municipio" checked>
                <span class="mode-label">Por Município (Detalhado)</span>
            </label>
            <label class="mode-option">
                <input type="radio" name="modo" value="regiao">
                <span class="mode-label">Por Região de Saúde</span>
            </label>
            <label class="mode-option">
                <input type="radio" name="modo" value="drsvi">
                <span class="mode-label">Visão Geral DRS VI</span>
            </label>
        </div>
    </div>

    <!-- Painel Lateral de Informações (Slide-in) -->
    <div id="info-sidebar" class="glass-panel">
        <div id="info-content">
            <div style="text-align: center; color: #999; margin-top: 20px;">
                <i class="fas fa-mouse-pointer" style="font-size: 30px; margin-bottom: 10px;"></i><br>
                Passe o mouse sobre o mapa<br>para ver detalhes
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ==================================================================
        // 0. DADOS RAW COMPLETOS
        // ==================================================================
        const csvDataRaw = `Cod municipio,Municipio,POSTO DE SAUDE,CENTRO DE SAUDE/UNIDADE BASICA,POLICLINICA,HOSPITAL GERAL,UNIDADE MISTA,PRONTO SOCORRO ESPECIALIZADO,CONSULTORIO ISOLADO,CLINICA/CENTRO DE ESPECIALIDADE,UNIDADE DE APOIO DIAGNOSE E TERAPIA (SADT ISOLADO),UNIDADE MOVEL DE NIVEL PRE-HOSPITALAR NA AREA DE URGENCIA,CENTRO DE ATENCAO PSICOSSOCIAL,PRONTO ATENDIMENTO,Total
350055,AGUAS DE SANTA BARBARA,0,3,0,0,0,0,0,0,1,0,0,1,6
350070,AGUDOS,0,8,1,1,0,0,0,1,1,0,1,2,16
350230,ANHEMBI,0,4,0,0,0,0,0,0,0,1,0,1,8
350310,ARANDU,0,1,0,1,0,0,0,0,0,0,0,0,3
350340,AREALVA,1,4,0,1,0,0,0,1,0,1,0,0,11
350360,AREIOPOLIS,0,3,1,0,0,0,0,1,2,1,0,0,10
350430,AVAI,0,3,0,0,0,0,0,0,0,0,0,0,5
350450,AVARE,0,22,0,1,0,1,6,7,5,2,1,0,50
350470,BALBINOS,0,4,0,0,0,0,0,0,0,0,0,0,6
350500,BARAO DE ANTONINA,0,2,0,0,0,0,0,0,0,0,0,0,4
350520,BARIRI,0,7,1,1,0,0,1,3,6,0,1,0,24
350530,BARRA BONITA,0,8,0,1,0,0,0,1,1,0,1,0,15
350600,BAURU,3,26,4,5,0,1,3,21,5,11,5,4,108
350680,BOCAINA,0,4,0,1,0,0,1,1,0,0,0,0,8
350690,BOFETE,1,6,0,0,0,0,0,0,0,0,0,1,10
350730,BORACEIA,0,2,0,0,0,0,0,0,0,0,0,1,5
350745,BOREBI,0,2,0,0,0,0,0,1,0,0,0,0,4
350750,BOTUCATU,0,23,1,2,0,0,3,17,2,3,4,0,67
350790,BROTAS,0,7,0,1,0,0,0,2,0,0,1,0,13
350830,CABRALIA PAULISTA,0,2,0,0,0,0,0,1,0,0,0,0,4
350880,CAFELANDIA,0,7,0,1,0,0,0,1,0,0,1,0,12
351140,CERQUEIRA CESAR,0,12,0,1,0,0,0,2,3,1,0,0,20
351230,CONCHAS,1,6,0,1,0,0,2,1,3,0,0,0,17
351260,CORONEL MACEDO,0,2,0,0,1,0,0,0,0,0,0,0,6
351410,DOIS CORREGOS,0,5,0,1,0,0,0,1,0,0,1,0,11
351450,DUARTINA,0,4,0,1,0,0,0,1,0,1,1,0,9
351540,FARTURA,0,4,0,1,0,0,0,1,3,1,0,0,13
351700,GETULINA,1,5,0,1,0,0,0,0,0,0,0,0,8
351720,GUAICARA,2,3,0,0,0,0,0,1,1,0,0,0,9
351910,IACANGA,0,4,1,1,0,0,0,1,0,1,1,0,11
351925,IARAS,0,6,0,0,0,0,0,0,0,0,0,0,8
352000,IGARACU DO TIETE,0,4,1,0,0,0,0,2,0,0,1,1,10
352180,ITAI,0,6,1,1,0,0,0,2,2,1,1,0,20
352200,ITAJU,0,1,0,0,0,0,0,0,0,0,0,0,2
352280,ITAPORANGA,0,4,2,1,0,0,1,2,0,1,0,0,18
352290,ITAPUI,0,3,0,1,0,0,0,3,0,1,1,1,11
352350,ITATINGA,0,4,0,1,0,0,0,0,2,0,0,0,9
352530,JAU,0,18,2,1,0,0,0,10,2,4,2,2,50
352640,LARANJAL PAULISTA,0,7,2,1,0,0,0,3,1,0,1,0,18
352680,LENCOIS PAULISTA,0,12,0,1,0,0,1,6,1,1,1,1,29
352710,LINS,2,14,1,2,0,0,0,6,9,0,3,0,43
352750,LUCIANOPOLIS,0,1,0,0,0,0,0,0,0,0,0,0,3
352800,MACATUBA,0,4,0,1,0,0,0,5,2,0,1,0,15
352860,MANDURI,1,2,1,0,0,0,0,0,0,0,0,0,6
352980,MINEIROS DO TIETE,0,3,0,0,0,0,0,4,0,0,1,0,10
353580,PARANAPANEMA,0,6,0,1,0,0,0,1,2,1,1,0,13
353610,PARDINHO,0,1,0,0,0,0,0,0,0,1,0,0,3
353657,PAULISTANIA,0,1,0,0,0,0,0,0,0,0,0,0,2
353670,PEDERNEIRAS,0,14,3,1,0,0,1,4,0,1,1,0,27
353750,PEREIRAS,2,2,1,0,0,0,0,0,0,0,0,0,7
353880,PIRAJU,0,10,0,1,0,0,0,4,5,0,1,0,24
353890,PIRAJUI,2,10,0,1,0,0,0,3,1,1,1,0,22
353940,PIRATININGA,3,1,0,1,0,0,0,1,1,1,0,0,13
354010,PONGAI,1,0,0,0,0,0,0,0,0,0,0,0,2
354050,PORANGABA,3,0,1,0,0,0,0,0,1,0,0,1,8
354105,PRATANIA,0,1,0,0,0,0,0,1,0,0,0,0,3
354110,PRESIDENTE ALVES,0,2,0,0,0,0,0,0,0,0,0,0,3
354160,PROMISSAO,0,10,0,1,0,0,2,1,7,0,1,0,23
354250,REGINOPOLIS,0,4,0,0,0,0,2,0,0,0,0,0,7
354460,SABINO,0,3,0,0,0,0,0,0,0,0,0,0,5
355010,SAO MANUEL,1,6,1,1,0,0,1,0,3,0,1,0,20
355120,SARUTAIA,0,1,0,0,0,0,0,0,0,0,0,0,2
355300,TAGUAI,0,5,0,1,0,0,0,0,1,1,0,0,9
355380,TAQUARITUBA,0,7,0,1,0,0,0,1,0,1,1,0,12
355420,TEJUPA,0,3,0,0,0,0,0,0,0,0,0,0,4
355465,TORRE DE PEDRA,0,1,0,0,0,0,0,0,0,0,0,0,4
355470,TORRINHA,0,2,0,1,0,0,1,0,1,0,0,0,8
355590,URU,0,1,0,0,0,0,0,0,0,0,0,0,3`;

        const csvRegionsRaw = `Departamento Regional de Saúde - DRS 6,,,,
,,,,
DRS 6,,,,
Polo Cuesta,Vale do Jurumirim,Bauru,Jaú,Lins
Anhembi*,Águas de Santa Bárbara,Agudos,Bariri,Cafelândia
Areiópolis,Arandu,Arealva,Barra Bonita,Getulina
Bofete*,Avaré,Avaí,Bocaína,Guaiçara
Botucatu,Barão de Antonina,Balbinos,Boracéia,Lins
Conchas,Cerqueira Césár,Bauru,Brotas,Pongaí
Itatinga,Coronel Macedo,Borebi,Dois Córregos,Promissão
Laranjal Paulista,Fartura,Cabrália Paulista,Igaraçu do Tietê,Sabino
Pardinho*,Iaras,Duartina,Itaju,Uru
Pereiras,Itaporanga,Iacanga,Itapuí,
Porangaba*,Itaí,Lençóis Paulista,Jaú,
Pratânia,Manduri,Lucianópolis,Mineiros do Tietê,
São Manuel,Paranapanema,Macatuba,Torrinha,
Torre de Pedra*,Piraju,Paulistânia,,
,Sarutaiá,Pederneiras,,
,Taguaí,Pirajuí,,
,Taquarituba,Piratininga,,
,Tejupá,Presidente Alves,,
,,Reginópolis,,
* Municípios com porta aberta no PSA,,,,`;

        const csvPrenatalRaw = `TOTAL,MUNICIPIO,ITEM,TIPO,ANO
294,BOTUCATU,PRE NATAL DIABETES,RETORNO,2024
254,BOTUCATU,PRE NATAL DIABETES,RETORNO,2025
84,SAO MANUEL,PRE NATAL DIABETES,RETORNO,2024
77,ITATINGA,PRE NATAL DIABETES,RETORNO,2024
73,PORANGABA,PRE NATAL DIABETES,RETORNO,2024
68,SAO MANUEL,PRE NATAL DIABETES,RETORNO,2025
52,ITATINGA,PRE NATAL DIABETES,RETORNO,2025
44,LARANJAL PAULISTA,PRE NATAL DIABETES,RETORNO,2025
35,PIRAJU,PRE NATAL DIABETES,RETORNO,2024
34,LARANJAL PAULISTA,PRE NATAL DIABETES,RETORNO,2024
33,BOFETE,PRE NATAL DIABETES,RETORNO,2025
30,CONCHAS,PRE NATAL DIABETES,RETORNO,2025
29,PARDINHO,PRE NATAL DIABETES,RETORNO,2024
29,PRATANIA,PRE NATAL DIABETES,RETORNO,2025
28,BOTUCATU,PRE NATAL DIABETES,CASO NOVO,2024
27,PARANAPANEMA,PRE NATAL DIABETES,RETORNO,2024
26,BARAO DE ANTONINA,PRE NATAL DIABETES,RETORNO,2024
23,PEREIRAS,PRE NATAL DIABETES,RETORNO,2025
22,PRATANIA,PRE NATAL DIABETES,RETORNO,2024
21,PEREIRAS,PRE NATAL DIABETES,RETORNO,2024
20,FARTURA,PRE NATAL DIABETES,RETORNO,2024
20,PORANGABA,PRE NATAL DIABETES,RETORNO,2025
20,CONCHAS,PRE NATAL DIABETES,RETORNO,2024
19,CERQUEIRA CESAR,PRE NATAL DIABETES,RETORNO,2025
19,CERQUEIRA CESAR,PRE NATAL DIABETES,RETORNO,2024
17,BOFETE,PRE NATAL DIABETES,RETORNO,2024
17,PARDINHO,PRE NATAL DIABETES,RETORNO,2025
17,BOTUCATU,PRE NATAL DIABETES,CASO NOVO,2025
16,AVARE,PRE NATAL DIABETES,RETORNO,2024
15,AREIOPOLIS,PRE NATAL DIABETES,RETORNO,2024
15,TORRE DE PEDRA,PRE NATAL DIABETES,RETORNO,2025
14,ITAPORANGA,PRE NATAL DIABETES,RETORNO,2024
14,PARANAPANEMA,PRE NATAL DIABETES,RETORNO,2025
13,PIRAJU,PRE NATAL DIABETES,RETORNO,2025
13,ANHEMBI,PRE NATAL DIABETES,RETORNO,2025
10,TORRE DE PEDRA,PRE NATAL DIABETES,RETORNO,2024
10,SAO MANUEL,PRE NATAL DIABETES,CASO NOVO,2024
9,MARISTELA / LARANJAL PAULISTA,PRE NATAL DIABETES,RETORNO,2024
9,ITATINGA,PRE NATAL DIABETES,CASO NOVO,2024
8,MANDURI,PRE NATAL DIABETES,RETORNO,2024
8,AVARE,PRE NATAL DIABETES,RETORNO,2025
7,AREIOPOLIS,PRE NATAL DIABETES,RETORNO,2025
6,BAURU,PRE NATAL DIABETES,RETORNO,2024
6,PARDINHO,PRE NATAL DIABETES,CASO NOVO,2024
6,SAO MANUEL,PRE NATAL DIABETES,CASO NOVO,2025
5,MACATUBA,PRE NATAL DIABETES,RETORNO,2024
5,HOLAMBRA II / PARANAPANEMA,PRE NATAL DIABETES,RETORNO,2024
4,BAURU,PRE NATAL DIABETES,RETORNO,2025
4,IARAS,PRE NATAL DIABETES,RETORNO,2025
4,PORANGABA,PRE NATAL DIABETES,CASO NOVO,2024
4,ITATINGA,PRE NATAL DIABETES,CASO NOVO,2025
4,PRATANIA,PRE NATAL DIABETES,CASO NOVO,2025
3,ITAI,PRE NATAL DIABETES,RETORNO,2025
3,ITAI,PRE NATAL DIABETES,RETORNO,2024
3,PEREIRAS,PRE NATAL DIABETES,CASO NOVO,2025
3,PARANAPANEMA,PRE NATAL DIABETES,CASO NOVO,2024
2,IARAS,PRE NATAL DIABETES,RETORNO,2024
2,ARANDU,PRE NATAL DIABETES,RETORNO,2024
2,SARUTAIA,PRE NATAL DIABETES,RETORNO,2025
2,PRATANIA,PRE NATAL DIABETES,CASO NOVO,2024
2,CONCHAS,PRE NATAL DIABETES,CASO NOVO,2024
2,TORRE DE PEDRA,PRE NATAL DIABETES,CASO NOVO,2024
2,CONCHAS,PRE NATAL DIABETES,CASO NOVO,2025
2,LARANJAL PAULISTA,PRE NATAL DIABETES,CASO NOVO,2025
2,PIRAJU,PRE NATAL DIABETES,CASO NOVO,2024
1,BOTUCATU,PRE NATAL DIABETES,REVISAO DE PARTO,2024
1,PARANAPANEMA,PRE NATAL DIABETES,REVISAO DE PARTO,2024
1,CERQUEIRA CESAR,PRE NATAL DIABETES,REVISAO DE PARTO,2024
1,MACATUBA,PRE NATAL DIABETES,REVISAO DE PARTO,2024
1,TAQUARITUBA,PRE NATAL DIABETES,RETORNO,2024
1,BARAO DE ANTONINA,PRE NATAL DIABETES,RETORNO,2025
1,MACATUBA,PRE NATAL DIABETES,RETORNO,2025
1,PEREIRAS,PRE NATAL DIABETES,CONSULTA EM PRONTO SOCORRO,2024
1,LARANJAL PAULISTA,PRE NATAL DIABETES,CONSULTA EM PRONTO SOCORRO,2024
1,BOFETE,PRE NATAL DIABETES,CONSULTA EM PRONTO SOCORRO,2024
1,CERQUEIRA CESAR,PRE NATAL DIABETES,COLOCACAO DIU,2024
1,AREIOPOLIS,PRE NATAL DIABETES,CASO NOVO,2025
1,ANHEMBI,PRE NATAL DIABETES,CASO NOVO,2025
1,LARANJAL PAULISTA,PRE NATAL DIABETES,CASO NOVO,2024
1,ITAI,PRE NATAL DIABETES,CASO NOVO,2024
1,ARANDU,PRE NATAL DIABETES,CASO NOVO,2024
1,AREIOPOLIS,PRE NATAL DIABETES,CASO NOVO,2024
1,PARANAPANEMA,PRE NATAL DIABETES,CASO NOVO,2025
1,ITAPORANGA,PRE NATAL DIABETES,CASO NOVO,2024
1,BARAO DE ANTONINA,PRE NATAL DIABETES,CASO NOVO,2024
1,PARDINHO,PRE NATAL DIABETES,CASO NOVO,2025`;

        const csvPartosRaw = `TOTAL,NM_CIDADE,DS_CIRURGIA,ANO
363,BOTUCATU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
327,BOTUCATU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
319,BOTUCATU,PARTO NORMAL,2024
301,BOTUCATU,PARTO NORMAL,2025
177,BOTUCATU,PARTO CESARIANO,2024
155,BOTUCATU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
149,BOTUCATU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
118,BOTUCATU,PARTO CESARIANO,2025
81,SAO MANUEL,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
61,SAO MANUEL,PARTO NORMAL,2025
59,SAO MANUEL,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
59,ITATINGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
53,ITATINGA,PARTO NORMAL,2024
50,ITATINGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
43,ITATINGA,PARTO NORMAL,2025
42,BOFETE,PARTO NORMAL,2024
37,PARDINHO,PARTO NORMAL,2025
34,SAO MANUEL,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
33,BOFETE,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
31,CONCHAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
28,PORANGABA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
27,LARANJAL PAULISTA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
25,CONCHAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
25,BOFETE,PARTO NORMAL,2025
25,BOFETE,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
24,SAO MANUEL,PARTO NORMAL,2024
23,LARANJAL PAULISTA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
23,ITATINGA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
23,PORANGABA,PARTO NORMAL,2025
22,SAO MANUEL,PARTO CESARIANO,2025
22,PORANGABA,PARTO NORMAL,2024
22,ITATINGA,PARTO CESARIANO,2024
22,AREIOPOLIS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
21,ANHEMBI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
21,AVARE,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
21,ITATINGA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
20,SAO MANUEL,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
20,BOFETE,PARTO CESARIANO,2024
20,PRATANIA,PARTO NORMAL,2025
20,ANHEMBI,PARTO NORMAL,2024
20,PARDINHO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
19,ANHEMBI,PARTO NORMAL,2025
19,PRATANIA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
19,AREIOPOLIS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
19,AVARE,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
18,PARDINHO,PARTO NORMAL,2024
18,PARANAPANEMA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
17,PEREIRAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
17,PARDINHO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
16,TAQUARITUBA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
16,PORANGABA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
16,AVARE,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
15,ANHEMBI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
15,PRATANIA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
15,ITAI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
14,PRATANIA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
14,ITAPORANGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
13,PIRAJU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
13,PIRAJU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
12,CERQUEIRA CESAR,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
12,TAGUAI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
12,AVARE,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
12,PARANAPANEMA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
12,BOFETE,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
11,FARTURA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
11,PRATANIA,PARTO CESARIANO,2025
11,BOFETE,PARTO CESARIANO,2025
11,PARDINHO,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
11,ITATINGA,PARTO CESARIANO,2025
11,PEREIRAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
11,ITAI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
11,AREIOPOLIS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
10,PARDINHO,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
10,ITAI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
10,FARTURA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
10,BOFETE,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
9,BOTUCATU,PARTO NORMAL COM EPISIOTOMIA,2024
9,PORANGABA,PARTO CESARIANO,2024
9,CERQUEIRA CESAR,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
8,PRATANIA,PARTO NORMAL,2024
8,ANHEMBI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
8,AREIOPOLIS,PARTO NORMAL,2024
8,AREIOPOLIS,PARTO NORMAL,2025
8,CONCHAS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
8,BOTUCATU,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
8,PORANGABA,PARTO CESARIANO,2025
7,TAQUARITUBA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
7,CONCHAS,PARTO NORMAL,2025
7,TORRE DE PEDRA,PARTO NORMAL,2024
7,PARDINHO,PARTO CESARIANO,2024
7,ANHEMBI,PARTO CESARIANO,2024
7,TORRE DE PEDRA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
7,PORANGABA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
7,LARANJAL PAULISTA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
6,TAGUAI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
6,BOTUCATU,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
6,CONCHAS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
6,TORRE DE PEDRA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
6,ANHEMBI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
6,IARAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
6,ITAI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
6,TORRE DE PEDRA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
6,SAO MANUEL,PARTO CESARIANO,2024
6,AREIOPOLIS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
5,AREIOPOLIS,PARTO CESARIANO,2024
5,PEREIRAS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
5,ITAI,PARTO NORMAL,2024
5,PIRAJU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
5,ITAI,PARTO NORMAL,2025
5,BAURU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
5,PORANGABA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
5,ARANDU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
5,CONCHAS,PARTO CESARIANO,2024
5,IARAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
5,CONCHAS,PARTO CESARIANO,2025
4,PRATANIA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
4,TAGUAI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
4,ANHEMBI,PARTO CESARIANO,2025
4,AREIOPOLIS,PARTO CESARIANO,2025
4,TORRE DE PEDRA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
4,BARAO DE ANTONINA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
4,PARANAPANEMA,PARTO NORMAL,2024
4,ARANDU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
4,AVARE,PARTO CESARIANO,2025
4,TAQUARITUBA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
4,PIRAJU,PARTO NORMAL,2024
4,SAO MANUEL,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
4,TEJUPA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
4,TAQUARITUBA,PARTO NORMAL,2025
4,CERQUEIRA CESAR,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
4,PEREIRAS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
3,CONCHAS,PARTO NORMAL,2024
3,TAQUARITUBA,PARTO CESARIANO,2024
3,CERQUEIRA CESAR,PARTO NORMAL,2024
3,BAURU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
3,PEREIRAS,PARTO CESARIANO,2024
3,CORONEL MACEDO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
3,CONCHAS,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
3,PARDINHO,PARTO CESARIANO,2025
3,AVARE,PARTO NORMAL,2024
3,ITAPORANGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
3,AVARE,PARTO NORMAL,2025
3,PEDERNEIRAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
3,SARUTAIA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
3,TAGUAI,PARTO NORMAL,2025
3,PIRAJU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
3,CORONEL MACEDO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
3,ITAI,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2024
3,LARANJAL PAULISTA,PARTO CESARIANO,2025
3,LARANJAL PAULISTA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
3,MANDURI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
3,LARANJAL PAULISTA,PARTO CESARIANO,2024
3,PEREIRAS,PARTO NORMAL,2024
2,PARANAPANEMA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,BARRA BONITA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
2,LENCOIS PAULISTA,PARTO CESARIANO,2024
2,PARANAPANEMA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
2,BOFETE,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
2,SARUTAIA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,SARUTAIA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
2,MARISTELA / LARANJAL PAULISTA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
2,PIRATININGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
2,CORONEL MACEDO,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
2,ITAPORANGA,PARTO CESARIANO,2024
2,CORONEL MACEDO,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,MANDURI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
2,CERQUEIRA CESAR,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
2,BOTUCATU,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2025
2,FARTURA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
2,TAQUARITUBA,PARTO NORMAL,2024
2,LARANJAL PAULISTA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
2,CERQUEIRA CESAR,PARTO NORMAL,2025
2,BAURU,PARTO NORMAL,2025
2,LARANJAL PAULISTA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
2,AGUDOS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,ITAI,PARTO CESARIANO,2024
2,DOIS CORREGOS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
2,PIRAJU,PARTO NORMAL,2025
2,TORRE DE PEDRA,PARTO NORMAL,2025
2,LENCOIS PAULISTA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,LENCOIS PAULISTA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
2,PIRAJU,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
2,LENCOIS PAULISTA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
2,BARAO DE ANTONINA,PARTO CESARIANO,2024
2,ITAPORANGA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,ITAI,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
2,PARANAPANEMA,PARTO CESARIANO,2024
2,LINS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
2,BOTUCATU,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2024
2,PRATANIA,PARTO CESARIANO,2024
2,LARANJAL PAULISTA,PARTO NORMAL,2024
1,PARDINHO,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,AGUAS DE SANTA BARBARA,PARTO CESARIANO,2024
1,PARDINHO,PARTO NORMAL COM EPISIOTOMIA,2024
1,BARRA BONITA,PARTO CESARIANO,2025
1,ARANDU,PARTO NORMAL,2024
1,IARAS,PARTO NORMAL,2025
1,IARAS,PARTO CESARIANO,2025
1,HOLAMBRA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,FARTURA,PARTO CESARIANO,2025
1,FARTURA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,NOVA BASSANO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,ITAI,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2025
1,ESPIRITO SANTO DO TURVO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,TEJUPA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,TAQUARITUBA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,ITAPORANGA,PARTO NORMAL,2025
1,CORONEL MACEDO,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2025
1,ITATINGA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
1,ITAPUI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,BOREBI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,TORRINHA,PARTO NORMAL,2025
1,HOLAMBRA II / PARANAPANEMA,PARTO CESARIANO,2024
1,HOLAMBRA II / PARANAPANEMA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,JAU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,AVARE,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2024
1,AGUDOS,PARTO CESARIANO,2025
1,PORANGABA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
1,LENCOIS PAULISTA,PARTO NORMAL,2025
1,LARANJAL PAULISTA,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2024
1,MANDURI,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
1,PEREIRAS,PARTO NORMAL,2025
1,BARRA BONITA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,AGUDOS,PARTO NORMAL,2024
1,AGUDOS,PARTO NORMAL,2025
1,MINEIROS DO TIETE,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2024
1,MANDURI,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2025
1,MACATUBA,PARTO NORMAL,2024
1,BARAO DE ANTONINA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
1,IARAS,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,IARAS,PARTO NORMAL,2024
1,ITAPORANGA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,BOFETE,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2024
1,SAO MANUEL,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2024
1,ITAPETININGA,PARTO NORMAL COM EPISIOTOMIA,2024
1,ITATINGA,PARTO NORMAL COM EPISIOTOMIA,2024
1,BROTAS,PARTO CESARIANO,2024
1,PIRATININGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,BERNARDINO DE CAMPOS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,PORTO FERREIRA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,CORONEL MACEDO,PARTO NORMAL,2024
1,TEJUPA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,TAGUAI,PARTO CESARIANO,2024
1,SAO PAULO,PARTO NORMAL,2025
1,CORONEL MACEDO,PARTO NORMAL,2025
1,PIRAJU,PARTO CESARIANO,2025
1,MINEIROS DO TIETE,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,MINEIROS DO TIETE,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,ANHEMBI,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,PARDINHO,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
1,PARANAPANEMA,PARTO CESARIANO,2025
1,BARRA BONITA,PARTO NORMAL,2025
1,CERQUEIRA CESAR,PARTO CESARIANO,2024
1,CORONEL MACEDO,PARTO CESARIANO,2024
1,SAO MANUEL,PARTO NORMAL COM EPISIOTOMIA,2025
1,HOLAMBRA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,BOTUCATU,PARTO NORMAL COM EPISIOTOMIA,2025
1,PEDERNEIRAS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,LENCOIS PAULISTA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,AGUDOS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,RIBEIRAO BRANCO,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,DOIS CORREGOS,PARTO CESARIANO,2025
1,MANDURI,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,BARAO DE ANTONINA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,TEJUPA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,TAGUAI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,LARANJAL,PARTO NORMAL,2025
1,SAO JOSE DO RIO PARDO,PARTO NORMAL,2024
1,ITAPORANGA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2024
1,MARISTELA / LARANJAL PAULISTA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,SAO PAULO,PARTO NORMAL,2024
1,LARANJAL,PARTO CESARIANO,2025
1,BOTUCATU,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2024
1,JUNDIAI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,TAGUAI,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,MANDURI,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,PARANAPANEMA,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,MANDURI,PARTO NORMAL,2025
1,ITAJU,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,ITABERA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,IACANGA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,MACATUBA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,PARDINHO,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2024
1,DOIS CORREGOS,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,ITAI,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,AGUAS DE SANTA BARBARA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,PARANAPANEMA,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2025
1,AREIOPOLIS,PARTO NORMAL DE ALTO RISCO COM EPISIOTOMIA,2024
1,ARARAS,PARTO NORMAL,2024
1,SANTA CRUZ DO RIO PARDO,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,PARANAPANEMA,PARTO NORMAL,2025
1,BAURU,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,BAURU,PARTO NORMAL,2024
1,SANTA CRUZ DO RIO PARDO,PARTO CESARIANO,2025
1,MANDURI,PARTO NORMAL,2024
1,TAQUARITUBA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,AGUAS DE SANTA BARBARA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2024
1,LENCOIS PAULISTA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,AREIOPOLIS,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2024
1,IACANGA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,AVARE,PARTO CESAREA GESTACAO GEMELAR OU MAIS,2025
1,ALAMBARI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,AVARE,PARTO CESARIANO,2024
1,TORRE DE PEDRA,PARTO CESARIANO,2025
1,BARIRI,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,ARANDU,PARTO NORMAL,2025
1,LINS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,ANGATUBA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2025
1,BOCAINA,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,BOTUCATU,PARTO NORMAL GESTACAO GEMELAR OU MAIS,2025
1,UBIRATA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,MARISTELA / LARANJAL PAULISTA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025
1,BROTAS,PARTO CESARIANO EM GESTACAO DE ALTO RISCO,2024
1,BOFETE,PARTO NORMAL COM EPISIOTOMIA,2024
1,PIRATININGA,PARTO NORMAL EM GESTACAO DE ALTO RISCO,2025`;

        const csvEquipamentosRaw = `Município,Gama Câmara,Mamógrafo com Comando Simples,Mamógrafo com Estereotaxia,Raio X até 100 mA,Raio X de 100 a 500 mA,Raio X mais de 500mA,Raio X Dentário,Raio X com Fluoroscopia,Raio X para Densitometria Óssea,Raio X para Hemodinâmica,Tomógrafo Computadorizado,Ressonância Magnética,Ultrassom Doppler Colorido,Ultrassom Ecógrafo,Ultrassom Convencional,Mamografo computadorizado,PET/CT,Grupo Gerador,Usina de Oxigênio,Endoscópio das Vias Respiratórias,Endoscópio das Vias Urinárias,Endoscópio Digestivo,Equipamentos para Optometria,Laparoscópio/Vídeo,Microcópio Cirúrgico,Cadeira Oftalmológica,Coluna Otalmológica,Refrator,Lensomêtro,Projetor ou Tabela de Optotipos,Retinoscópio,Oftalmoscópio,Ceratômetro,Tonômetro de Aplanação,Biomicroscópio (Lâmpada de Fenda),Campímetro,Eletrocardiógrafo,Eletroencefalógrafo,Bomba/Balão Intra-Aórtico,Bomba de Infusão,Berço Aquecido,Bilirrubinômetro,Debitômetro,Desfibrilador,Equipamento de Fototerapia,Incubadora,Marcapasso Temporário,Monitor de ECG,Monitor de Pressão Invasivo,Monitor de Pressão Não-Invasivo,Reanimador Pulmonar/AMBU,Respirador/Ventilador,Aparelho de Diatermia por Ultrassom/Ondas Curtas,Aparelho de Eletroestimulação,Bomba de Infusão de Hemoderivados,Equipamentos de Aférese,Equipamento de Circulação Extracorpórea,Equipamento para Hemodiálise,Forno de Bier,Equipo Odontológico Completo,Compressor Odontológico,Fotopolimerizador,Caneta de Alta Rotação,Caneta de Baixa Rotação,Amalgamador,Aparelho de Profilaxia c/Jato de Bicarbonato,Emissões Otoacusticas Evocadas Transientes,Emissões Otoacusticas Evocadas por Prod. de Dist,Potencial Evocado Auditivo de Tronco Encef Autom,Pot Evocado Aud Tronco Encef. Curta Media e Long,Audiometro de um Canal,Audiometro de dois Canal,Imitanciometro,Imitanciometro Multifrequencial,Cabine  Acustica,Sistema DE Campo Livre,Sistema Completo de reforço Visual (VRA),Ganho de Inserção,Detector Fetal Portatil,Ultrassom Portatil,Aparelho de Hemodialise - Ambulatorial,Aparelho de Hemodialise - Hospitalar,Aparelho de Hemodialise Reserva,Aparelho para Dialise Peritonial,Total
AGUAS DE SANTA BARBARA,0,0,0,0,0,0,6,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,4,0,1,0,0,0,0,0,2,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24
AGUDOS,0,0,0,3,2,0,8,0,0,0,1,0,1,1,2,0,0,2,0,0,0,1,2,1,2,4,4,4,4,4,4,4,3,4,3,2,14,1,0,8,4,0,0,4,1,3,0,8,2,20,7,4,1,1,0,3,0,0,2,35,10,15,14,14,6,13,0,0,0,0,2,0,0,0,1,0,0,0,0,0,0,0,0,0,265
ANHEMBI,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,2,0,0,0,2,0,0,6,0,0,0,0,0,0,0,0,4,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26
ARANDU,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,2,0,1,0,2,0,1,4,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21
AREALVA,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,6,1,0,0,3,1,1,0,6,0,6,9,3,0,0,0,0,0,0,0,4,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,49
AREIOPOLIS,0,0,0,0,0,0,4,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,1,1,1,1,1,1,1,1,1,0,4,0,0,0,0,0,0,1,0,0,0,0,0,0,2,0,0,2,0,0,1,0,0,11,2,2,4,3,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,52
AVAI,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22
AVARE,0,4,0,4,6,1,43,2,2,0,4,3,14,6,15,0,0,6,2,2,2,9,1,0,5,5,3,4,3,2,4,3,3,1,3,1,51,10,0,90,11,1,0,24,4,15,2,13,2,39,91,49,24,35,0,0,0,0,5,74,54,51,66,54,45,41,5,2,1,1,1,4,3,1,3,0,0,0,0,0,34,3,5,0,1222
BALBINOS,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,1,4,2,1,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23
BARAO DE ANTONINA,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,1,0,1,0,10,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23
BARIRI,0,1,0,2,2,0,3,0,0,0,0,0,2,3,6,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,9,2,0,6,6,0,0,3,2,1,0,15,0,6,6,11,3,3,0,0,0,0,1,18,1,1,1,1,1,0,1,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,123
BARRA BONITA,0,1,0,4,2,2,16,1,0,0,2,0,2,2,2,0,0,2,0,0,0,2,8,1,1,2,2,1,2,2,2,2,1,2,1,2,23,3,6,5,2,0,0,14,2,6,0,13,2,14,17,10,25,31,8,3,0,0,4,33,22,29,47,32,20,21,1,0,0,0,2,2,0,0,3,0,0,0,0,0,0,0,0,0,481
BAURU,6,11,2,30,33,17,185,9,7,7,23,10,74,20,48,2,0,39,9,34,40,55,52,27,54,32,30,30,16,28,26,67,16,28,33,7,183,24,7,679,46,2,0,168,54,72,26,517,140,543,520,300,64,101,0,18,6,28,7,675,181,269,408,338,127,176,16,14,9,20,48,31,51,26,64,15,9,27,0,0,62,13,11,54,7479
BOCAINA,0,0,0,0,1,0,4,0,0,0,0,0,3,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,1,1,2,0,2,0,0,5,2,3,2,0,0,0,0,1,8,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,49
BOFETE,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,9,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28
BORACEIA,0,0,0,0,0,0,1,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,1,1,1,0,0,0,0,0,0,1,3,1,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17
BOREBI,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5
BOTUCATU,2,2,5,11,11,9,77,11,1,2,7,4,23,9,47,1,1,26,6,5,11,40,28,15,19,15,8,11,7,10,7,46,6,14,17,4,107,11,3,870,39,1,0,112,43,37,11,287,38,66,141,165,56,73,0,6,2,1,5,153,105,74,139,90,59,48,4,2,4,0,2,8,7,1,6,3,0,0,0,0,36,12,14,99,3511
BROTAS,0,0,0,1,1,0,20,1,0,0,1,0,0,1,2,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,8,0,0,11,2,0,0,4,1,2,0,3,0,3,6,1,11,11,0,0,0,0,2,29,6,7,6,6,4,4,0,0,0,0,1,2,0,0,2,0,0,0,0,0,0,0,0,0,163
CABRALIA PAULISTA,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,3,2,3,3,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25
CAFELANDIA,0,0,0,0,2,0,9,0,0,0,0,0,2,1,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,6,4,0,0,4,2,3,0,4,0,12,10,3,9,6,0,0,0,0,2,18,15,19,27,20,12,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,219
CERQUEIRA CESAR,0,1,0,1,3,0,3,0,0,0,0,0,0,2,3,0,0,2,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,6,0,0,5,2,0,0,6,2,2,0,5,0,4,7,6,6,8,0,0,0,0,2,20,12,10,14,12,10,7,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,184
CONCHAS,0,1,0,3,1,0,10,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,9,1,0,4,1,0,0,3,3,2,1,5,0,10,5,2,4,5,0,0,0,0,2,17,7,7,9,8,6,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,140
CORONEL MACEDO,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,6,2,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24
DOIS CORREGOS,0,1,0,1,0,2,7,0,0,0,0,0,0,1,2,0,0,1,0,0,0,0,2,1,2,4,3,2,3,4,2,3,1,3,3,2,11,1,0,0,2,0,0,2,3,3,0,4,2,2,9,2,7,4,0,0,0,0,4,10,8,11,15,13,4,10,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,192
DUARTINA,1,0,0,1,3,0,7,0,0,0,0,0,1,3,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,1,2,0,0,4,2,2,0,3,0,5,3,3,4,2,0,3,0,0,2,15,9,12,18,13,7,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,146
FARTURA,0,1,0,1,1,0,7,0,0,0,0,0,0,1,1,0,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,2,1,0,0,2,1,2,0,1,0,6,9,3,2,3,0,0,0,0,1,15,4,3,5,3,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96
GETULINA,0,0,0,1,1,0,5,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,1,0,0,1,1,2,0,2,0,6,5,2,3,4,0,0,0,0,4,14,6,7,18,11,13,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115
GUAICARA,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,6,10,0,0,0,0,3,17,9,12,21,13,5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,113
IACANGA,0,0,0,0,1,1,6,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,2,1,2,0,0,0,2,8,0,4,7,0,0,0,0,1,10,4,4,10,7,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80
IARAS,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,4,0,0,0,4,0,1,4,2,1,1,0,0,0,0,0,6,2,1,1,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45
IGARACU DO TIETE,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,0,1,0,0,0,1,0,0,0,0,0,3,0,0,2,3,0,1,0,0,1,10,5,5,6,7,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63
ITAI,1,1,0,0,1,0,1,0,0,1,2,0,2,0,3,0,0,1,2,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,1,0,9,0,0,12,3,0,0,6,1,2,0,5,0,5,12,5,2,3,0,0,0,0,5,7,5,5,9,6,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,140
ITAJU,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,1,1,2,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12
ITAPORANGA,0,0,0,1,1,0,0,0,0,0,1,0,2,0,2,0,0,2,1,0,0,1,0,1,0,0,0,0,0,0,0,3,0,0,0,0,7,0,0,0,3,0,0,6,2,3,0,9,0,12,12,6,1,2,7,0,0,0,1,4,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,91
ITAPUI,0,0,0,0,2,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,4,0,0,0,2,0,8,6,2,0,4,0,0,0,0,0,4,4,4,7,4,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61
ITATINGA,0,0,0,0,1,0,7,0,0,0,0,0,0,0,2,0,0,1,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,7,1,0,4,1,0,0,4,0,2,0,4,0,2,6,3,8,10,0,0,0,0,2,20,18,18,23,17,16,7,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,194
JAU,4,5,4,4,13,8,34,9,4,1,8,4,22,9,19,1,1,13,12,11,49,38,34,13,20,25,20,23,22,21,18,25,17,19,18,7,84,8,0,480,22,0,0,99,27,23,10,111,161,204,336,130,62,75,0,4,1,2,2,78,44,44,77,53,21,34,6,2,2,2,6,6,5,4,10,2,2,1,0,0,38,10,5,0,2892
LARANJAL PAULISTA,0,1,0,0,1,1,11,0,0,0,1,0,4,2,6,1,0,1,2,2,0,6,2,3,0,0,0,0,0,0,0,0,0,0,0,0,7,2,0,10,4,1,0,5,4,2,0,2,17,7,13,15,11,11,0,0,0,0,6,15,4,2,13,7,0,3,0,0,0,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,212
LENCOIS PAULISTA,0,3,0,3,6,3,30,0,3,0,1,4,8,5,7,0,0,2,0,3,2,3,5,3,3,1,0,1,1,1,0,1,0,0,1,1,29,4,0,61,6,0,6,17,5,4,2,29,19,111,47,24,46,52,0,0,0,0,8,39,19,20,28,23,14,13,1,0,0,0,1,3,0,0,1,0,0,0,0,0,0,0,0,0,746
LINS,1,3,0,20,6,3,173,1,3,0,7,3,15,8,9,0,0,5,1,10,4,4,10,6,5,9,6,6,7,7,6,10,6,7,8,2,39,4,0,59,5,0,0,28,9,22,7,64,11,41,126,59,49,128,0,2,0,21,7,297,205,241,362,268,105,180,1,0,0,0,3,5,2,1,10,0,0,0,0,0,0,0,0,0,2824
LUCIANOPOLIS,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,3,0,0,0,0,0,3,3,3,5,5,5,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,37
MACATUBA,0,0,0,1,3,0,5,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,2,0,0,1,2,5,0,7,7,14,9,7,4,8,0,0,0,0,3,19,20,12,21,17,12,10,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,225
MANDURI,0,0,0,0,0,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,7,0,0,2,0,0,4,6,0,0,0,2,1,1,6,2,0,0,0,0,0,0,0,6,5,5,4,3,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68
MINEIROS DO TIETE,0,0,0,0,1,1,1,0,0,0,0,0,1,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,1,0,1,0,0,0,0,0,0,0,2,0,0,2,1,2,2,0,3,1,0,1,4,4,4,7,4,4,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,60
PARANAPANEMA,0,0,0,7,0,1,8,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,1,0,0,2,1,2,0,1,1,2,11,2,2,4,0,0,0,0,1,18,19,23,27,18,17,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,191
PARDINHO,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,3,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,1,0,4,9,0,2,1,0,0,0,0,1,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,35
PAULISTANIA,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23
PEDERNEIRAS,0,2,0,3,2,0,11,0,0,0,1,0,3,0,2,0,0,2,0,1,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,11,2,0,25,3,0,0,3,1,1,0,6,1,27,1,13,6,6,0,0,1,0,2,47,25,28,54,51,13,20,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,385
PEREIRAS,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,6,1,1,5,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24
PIRAJU,0,0,0,1,3,0,19,0,1,0,2,0,1,2,8,3,0,1,1,4,1,0,3,2,0,0,0,0,0,0,0,0,0,0,0,0,18,1,0,8,3,0,0,7,4,4,1,14,5,60,35,8,13,11,0,0,1,0,5,47,27,35,56,46,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,519
PIRAJUI,0,0,0,3,3,0,7,1,0,0,1,0,3,3,2,0,0,2,1,0,0,1,1,0,0,0,0,0,0,0,0,3,0,0,0,0,13,0,0,6,3,1,0,4,1,3,1,14,0,7,11,4,4,2,0,0,0,0,4,22,9,13,29,16,9,9,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,222
PIRATININGA,0,0,0,0,1,1,1,0,0,0,0,0,1,2,1,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,3,0,0,0,3,0,0,0,4,0,1,5,4,0,0,0,0,0,0,0,4,4,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47
PONGAI,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11
PORANGABA,0,0,0,0,1,0,2,0,0,0,0,0,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,2,0,0,0,0,0,3,0,0,0,0,0,0,6,2,0,0,0,0,0,0,0,6,3,2,3,3,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,52
PRATANIA,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,3,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16
PRESIDENTE ALVES,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,2,0,0,0,0,0,0,0,0,2,2,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17
PROMISSAO,0,1,1,1,3,1,13,0,1,0,1,0,4,4,10,0,0,2,0,1,1,4,1,1,2,1,1,1,1,1,1,2,1,1,1,1,20,2,0,4,3,0,0,17,2,1,2,13,0,19,51,21,12,13,0,0,0,0,5,39,27,36,55,44,7,15,0,0,0,0,0,2,0,0,1,0,0,0,0,0,20,1,1,0,527
REGINOPOLIS,0,0,0,1,0,0,5,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,8,0,4,2,0,0,0,0,1,6,4,6,6,4,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,65
SABINO,0,0,0,0,0,0,4,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,5,3,3,6,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,39
SAO MANUEL,0,1,0,2,4,1,8,1,0,0,1,0,1,1,6,0,0,2,1,0,0,5,6,0,1,1,0,0,0,0,0,2,0,0,0,0,13,2,0,35,4,0,0,4,4,3,1,6,10,18,35,14,3,13,0,10,0,0,0,39,21,21,21,20,30,21,1,0,0,0,0,2,0,0,2,0,0,0,0,1,1,0,0,0,400
SARUTAIA,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8
TAGUAI,0,0,0,1,1,0,2,0,0,0,0,0,2,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,4,2,0,0,4,2,1,0,3,0,3,7,5,2,2,0,0,0,0,1,6,3,3,5,5,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,92
TAQUARITUBA,0,1,0,1,2,0,2,0,0,0,1,0,0,3,1,1,0,2,1,0,0,2,0,1,0,1,1,1,1,1,1,1,1,1,0,0,10,1,0,18,2,0,0,5,2,2,1,3,0,0,12,19,2,7,0,0,0,0,2,13,7,9,10,8,7,7,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,177
TEJUPA,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5
TORRE DE PEDRA,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,3,1,0,0,0,0,0,0,0,1,2,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,16
TORRINHA,0,0,0,0,1,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,3,0,0,1,1,2,0,2,0,0,3,1,2,1,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26
URU,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4`;

        // ==================================================================
        // 1. INICIALIZAÇÃO E MAPA
        // ==================================================================
        const map = L.map('map', {
            zoomControl: false,
            attributionControl: false 
        }).setView([-22.8, -49.0], 9);

        L.control.zoom({ position: 'bottomright' }).addTo(map);

        L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
            maxZoom: 19
        }).addTo(map);

        let currentMode = 'municipio';
        let geojsonLayer;
        let selectedLayer = null;

        // Estruturas de Dados
        const partosMap = new Map();
        const partosDetalhados = new Map();
        const prenatalMap = new Map();
        const prenatalDetalhados = new Map();
        const regionMap = new Map();
        const regionTotals = new Map();
        const regionDetailsMap = new Map();
        const ibgeToRegionMap = new Map();
        const dataMap = new Map();
        const nameToIbgeMap = new Map();
        
        // Novos mapas para equipamentos
        const equipamentosDetalhados = new Map(); // Chave: Nome Normalizado, Valor: Objeto { Equipamento: Qtd }
        let headersUnidades = [];

        // ==================================================================
        // 2. PROCESSAMENTO DE DADOS
        // ==================================================================
        function normalizeString(str) {
            if (!str || typeof str !== 'string') return '';
            return str.trim().toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace("*", "");
        }

        function processAllData() {
            // 1. Unidades
            const lines = csvDataRaw.trim().split('\n');
            headersUnidades = lines[0].split(',');
            
            // Regions
            const regLines = csvRegionsRaw.trim().split('\n');
            const regionNames = regLines[3].split(',');
            regionNames.forEach(name => {
                if(name.trim()) regionTotals.set(name.trim(), 0);
            });
            for(let i=4; i<regLines.length; i++){
                const row = regLines[i].split(',');
                if(row.length < regionNames.length) continue;
                for(let col=0; col<regionNames.length; col++){
                    const regName = regionNames[col].trim();
                    const mun = normalizeString(row[col]);
                    if(regName && mun) regionMap.set(mun, regName);
                }
            }

            // Unidades Loop (Popula dataMap e nameToIbgeMap)
            for (let i = 1; i < lines.length; i++) {
                const row = lines[i].split(',');
                if(row.length < headersUnidades.length) continue;
                
                const obj = {};
                let total = 0;
                headersUnidades.forEach((h, idx) => {
                    obj[h.trim()] = row[idx].trim();
                    if(h !== 'Cod municipio' && h !== 'Municipio' && h !== 'Total') {
                        total += parseInt(row[idx]) || 0;
                    }
                });
                obj.Total = total;
                const ibge = obj['Cod municipio'];
                const nome = normalizeString(obj['Municipio']);
                
                dataMap.set(ibge, obj);
                nameToIbgeMap.set(nome, ibge);
                
                const reg = regionMap.get(nome) || 'Outros';
                ibgeToRegionMap.set(ibge, reg);
                regionTotals.set(reg, (regionTotals.get(reg)||0) + total);
            }

            // 2. Equipamentos (Processamento Novo)
            const linesEquip = csvEquipamentosRaw.trim().split('\n');
            const headerEquip = linesEquip[0].split(',');
            
            for(let i=1; i<linesEquip.length; i++) {
                const cols = linesEquip[i].split(',');
                const nomeMun = normalizeString(cols[0]);
                
                // Ignorar linhas vazias ou mal formatadas
                if(cols.length < headerEquip.length) continue;

                const listaEquip = {};
                // Começa do índice 1 (pula nome) e vai até penúltimo (ignora total se quiser calcular, ou usa)
                // O último é Total, vamos ignorar para listar só itens
                for(let k=1; k < cols.length - 1; k++) {
                    const qtd = parseInt(cols[k]);
                    if(qtd > 0) {
                        listaEquip[headerEquip[k].trim()] = qtd;
                    }
                }
                equipamentosDetalhados.set(nomeMun, listaEquip);
            }

            // 3. Partos
            const linesPartos = csvPartosRaw.trim().split('\n');
            for (let i = 1; i < linesPartos.length; i++) {
                const parts = linesPartos[i].split(',');
                if (parts.length >= 4) {
                    const total = parseInt(parts[0]);
                    const municipio = normalizeString(parts[1]);
                    const tipoParto = parts[2].trim();
                    const ano = parts[3].trim();
                    if (!isNaN(total) && municipio) {
                        partosMap.set(municipio, (partosMap.get(municipio) || 0) + total);
                        if (!partosDetalhados.has(municipio)) partosDetalhados.set(municipio, []);
                        partosDetalhados.get(municipio).push({ tipo: tipoParto, ano: ano, total: total });
                    }
                }
            }

            // 4. Prenatal
            const linesPrenatal = csvPrenatalRaw.trim().split('\n');
            for (let i = 1; i < linesPrenatal.length; i++) {
                const parts = linesPrenatal[i].split(',');
                if (parts.length >= 5) {
                    const total = parseInt(parts[0]);
                    const municipio = normalizeString(parts[1]);
                    const item = parts[2].trim();
                    const tipo = parts[3].trim();
                    const ano = parts[4].trim();
                    if (!isNaN(total) && municipio) {
                        prenatalMap.set(municipio, (prenatalMap.get(municipio) || 0) + total);
                        if (!prenatalDetalhados.has(municipio)) prenatalDetalhados.set(municipio, []);
                        prenatalDetalhados.get(municipio).push({ item: item, tipo: tipo, ano: ano, total: total });
                    }
                }
            }

            // Datalist
            const dataList = document.getElementById('city-list');
            const sortedNames = Array.from(nameToIbgeMap.keys()).sort();
            sortedNames.forEach(nome => {
                const option = document.createElement('option');
                option.value = nome;
                dataList.appendChild(option);
            });
        }

        processAllData();

        // ==================================================================
        // 3. ESTILIZAÇÃO E TOOLTIPS
        // ==================================================================
        function getRegionColor(region) {
            const colors = {
                'Polo Cuesta': '#00a8cc',
                'Vale do Jurumirim': '#ff9f43',
                'Bauru': '#feca57',
                'Jaú': '#ff6b6b',
                'Lins': '#54a0ff',
                'Sem Regiao': '#c8d6e5'
            };
            return colors[region] || '#c8d6e5';
        }

        function style(feature) {
            const ibge = String(feature.properties.id || feature.properties.CD_MUN).substring(0, 6);
            const region = ibgeToRegionMap.get(ibge);
            const hasData = dataMap.has(ibge);

            return {
                fillColor: hasData ? getRegionColor(region) : '#eee',
                weight: 1,
                opacity: 1,
                color: 'white',
                dashArray: '',
                fillOpacity: 0.75
            };
        }

        function onEachFeature(feature, layer) {
            const ibge = String(feature.properties.id || feature.properties.CD_MUN).substring(0, 6);
            const data = dataMap.get(ibge);
            
            if (data) {
                layer.bindTooltip(`<strong>${data.Municipio}</strong>`, {
                    permanent: false,
                    direction: "top",
                    className: "smart-tooltip",
                    offset: [0, -10],
                    opacity: 1
                });
                layer.on({
                    mouseover: highlightFeature,
                    mouseout: resetHighlight,
                    click: (e) => selectFeature(e.target)
                });
            }
        }

        function highlightFeature(e) {
            const layer = e.target;
            const ibge = String(layer.feature.properties.id).substring(0, 6);
            layer.setStyle({ weight: 3, color: '#2f3542', fillOpacity: 0.95 });
            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }
            if(currentMode === 'regiao') {
                const region = ibgeToRegionMap.get(ibge);
                highlightRegion(region);
            }
        }

        function resetHighlight(e) {
            if(currentMode !== 'regiao') geojsonLayer.resetStyle(e.target);
            if(selectedLayer && selectedLayer === e.target) {
                selectedLayer.setStyle({ weight: 3, color: '#2f3542' });
            }
        }

        function selectFeature(layer) {
            if(selectedLayer) geojsonLayer.resetStyle(selectedLayer);
            selectedLayer = layer;
            const ibge = String(layer.feature.properties.id).substring(0, 6);
            const data = dataMap.get(ibge);
            if(currentMode === 'municipio') updateSidebarMunicipios(data);
            else if (currentMode === 'regiao') {
                const region = ibgeToRegionMap.get(ibge);
                updateSidebarRegion(region);
            }
            map.flyToBounds(layer.getBounds(), { padding: [50, 50], duration: 0.8 });
        }

        function highlightRegion(regionName) {
            geojsonLayer.eachLayer(layer => {
                const lIbge = String(layer.feature.properties.id).substring(0, 6);
                const lRegion = ibgeToRegionMap.get(lIbge);
                if(lRegion === regionName) layer.setStyle({ fillOpacity: 1, color: '#555', weight: 1.5 });
                else layer.setStyle({ fillOpacity: 0.3, color: 'white', weight: 1 });
            });
        }

        // ==================================================================
        // 4. ATUALIZAÇÃO DO PAINEL LATERAL
        // ==================================================================
        const sidebar = document.getElementById('info-sidebar');
        const content = document.getElementById('info-content');

        function updateSidebarMunicipios(data) {
            sidebar.classList.add('active');
            const region = ibgeToRegionMap.get(data['Cod municipio']);
            
            let html = `
                <div class="info-header">
                    <span>Região: ${region}</span>
                    <h2>${data.Municipio}</h2>
                </div>
                <div class="data-card">
                    <h4><i class="fas fa-hospital-alt"></i> Total de Unidades</h4>
                    <span class="big-number">${data.Total}</span>
                </div>
                <div class="data-card">
                    <h4><i class="fas fa-list-ul"></i> Detalhes da Rede</h4>
            `;

            const iconMap = { 'HOSPITAL GERAL': 'fa-procedures', 'CENTRO DE SAUDE/UNIDADE BASICA': 'fa-user-md', 'PRONTO SOCORRO': 'fa-ambulance' };

            headersUnidades.forEach(h => {
                const val = parseInt(data[h.trim()]);
                if (val > 0 && h !== 'Total' && h !== 'Cod municipio' && h !== 'Municipio') {
                    let iconClass = 'fa-circle';
                    for(const key in iconMap) if(h.includes(key)) iconClass = iconMap[key];
                    html += `
                        <div class="stat-row">
                            <span class="stat-label"><i class="fas ${iconClass}" style="font-size:10px; color:#ccc; margin-right:5px;"></i> ${h}</span>
                            <span class="stat-value">${val}</span>
                        </div>
                    `;
                }
            });

            html += `</div>
                <button class="btn-action" onclick="printReport('${data.Municipio}')">
                    <i class="fas fa-print"></i> Imprimir Relatório
                </button>
            `;
            content.innerHTML = html;
        }

        function updateSidebarRegion(regionName) {
            sidebar.classList.add('active');
            const total = regionTotals.get(regionName);
            let html = `
                <div class="info-header" style="border-color: ${getRegionColor(regionName)}">
                    <span>Departamento Regional</span>
                    <h2 style="color:${getRegionColor(regionName)}">${regionName}</h2>
                </div>
                <div class="data-card">
                    <h4>População de Unidades</h4>
                    <span class="big-number" style="color:${getRegionColor(regionName)}">${total}</span>
                </div>
                <div style="padding:10px; color:#666; font-size:13px;">
                    <i class="fas fa-info-circle"></i> Dados consolidados de todos os municípios desta microrregião.
                </div>
                <button class="btn-action" onclick="printRegionReport('${regionName}')">
                    <i class="fas fa-print"></i> Imprimir Relatório Regional
                </button>
            `;
            content.innerHTML = html;
        }

        document.querySelector('.search-input').addEventListener('change', function(e) {
            const val = normalizeString(this.value);
            if(nameToIbgeMap.has(val)) {
                const ibge = nameToIbgeMap.get(val);
                geojsonLayer.eachLayer(layer => {
                    if(String(layer.feature.properties.id).substring(0, 6) === ibge) selectFeature(layer);
                });
            }
        });

        document.querySelectorAll('input[name="modo"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                currentMode = e.target.value;
                geojsonLayer.resetStyle();
                sidebar.classList.remove('active');
                if(currentMode === 'drsvi') {
                    geojsonLayer.setStyle({ fillOpacity: 0.9, color: '#333' });
                    let totalUnidades = 0;
                    dataMap.forEach(d => totalUnidades += d.Total);
                    content.innerHTML = `
                        <div class="info-header"><h2>DRS VI Completa</h2></div>
                        <div class="data-card">
                            <h4>Visão Geral</h4>
                            <span class="big-number">${totalUnidades}</span>
                            <p style="text-align:center; color:#666; font-size:12px;">Total de Unidades de Saúde</p>
                        </div>
                        <button class="btn-action" onclick="printDRSVIReport()">
                            <i class="fas fa-print"></i> Imprimir Dossiê Completo
                        </button>
                    `;
                    sidebar.classList.add('active');
                }
            });
        });

        // ==================================================================
        // 5. FUNÇÕES DE IMPRESSÃO (Município, Região, Geral) + EQUIPAMENTOS
        // ==================================================================
        
        // --- MUNICÍPIO ---
        window.printReport = function(munName) {
            const normName = normalizeString(munName);
            const ibge = nameToIbgeMap.get(normName);
            const data = dataMap.get(ibge);

            if (!data) { alert("Dados não encontrados."); return; }

            let munFeature = null;
            geojsonLayer.eachLayer(layer => {
                if (String(layer.feature.properties.id).substring(0, 6) === ibge) munFeature = layer.feature;
            });

            const detalhesPartos = partosDetalhados.get(normName) || [];
            const detalhesPrenatal = prenatalDetalhados.get(normName) || [];
            const equipData = equipamentosDetalhados.get(normName) || {};

            let totalPartos = 0;
            detalhesPartos.forEach(p => totalPartos += p.total);
            let totalPrenatal = 0;
            detalhesPrenatal.forEach(p => totalPrenatal += p.total);

            generatePrintWindow(munName, 'Relatório Executivo Municipal', data.Total, totalPartos, totalPrenatal, 
                generateUnitsHtml(data), generatePartosHtml(detalhesPartos), generatePrenatalHtml(detalhesPrenatal), generateEquipamentosHtml(equipData), munFeature, '#0056b3');
        };

        // --- REGIÃO ---
        window.printRegionReport = function(regionName) {
            let totalUnidades = 0;
            let totalPartos = 0;
            let totalPrenatal = 0;
            
            // Agregar Equipamentos da Região
            const equipAgregados = {};

            let citiesHtml = '<div class="section"><h3>Municípios da Região</h3><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">';
            const features = [];

            dataMap.forEach((data, ibge) => {
                if (ibgeToRegionMap.get(ibge) === regionName) {
                    const normName = normalizeString(data.Municipio);
                    totalUnidades += data.Total;
                    
                    const p = partosMap.get(normName) || 0;
                    totalPartos += p;
                    const pr = prenatalMap.get(normName) || 0;
                    totalPrenatal += pr;

                    // Agregar Equipamentos
                    const eqs = equipamentosDetalhados.get(normName);
                    if(eqs) {
                        for(const [eqName, qtd] of Object.entries(eqs)) {
                            equipAgregados[eqName] = (equipAgregados[eqName] || 0) + qtd;
                        }
                    }

                    citiesHtml += `<div style="background:#f9f9f9; padding:5px; border-left:3px solid #ccc;"><b>${data.Municipio}</b><br>Unidades: ${data.Total}</div>`;
                }
            });
            citiesHtml += '</div></div>';

            geojsonLayer.eachLayer(layer => {
                if (ibgeToRegionMap.get(String(layer.feature.properties.id).substring(0, 6)) === regionName) {
                    features.push(layer.feature);
                }
            });

            const featureCollection = { type: "FeatureCollection", features: features };
            
            generatePrintWindow(regionName, 'Relatório Regional Consolidado', totalUnidades, totalPartos, totalPrenatal, 
                citiesHtml, generateEquipamentosHtml(equipAgregados), '', featureCollection, getRegionColor(regionName));
        };

        // --- DRS VI GERAL ---
        window.printDRSVIReport = function() {
            let totalUnidades = 0;
            let totalPartos = 0;
            let totalPrenatal = 0;
            const equipAgregados = {};

            let regionsHtml = '<div class="section"><h3>Resumo por Região</h3>';
            
            regionTotals.forEach((total, region) => {
                if(region !== 'Sem Regiao') {
                    totalUnidades += total;
                    let rPartos = 0;
                    let rPrenatal = 0;
                    dataMap.forEach((d, ibge) => {
                        if(ibgeToRegionMap.get(ibge) === region) {
                            const normName = normalizeString(d.Municipio);
                            rPartos += (partosMap.get(normName) || 0);
                            rPrenatal += (prenatalMap.get(normName) || 0);
                            
                            // Agregar Equipamentos
                            const eqs = equipamentosDetalhados.get(normName);
                            if(eqs) {
                                for(const [eqName, qtd] of Object.entries(eqs)) {
                                    equipAgregados[eqName] = (equipAgregados[eqName] || 0) + qtd;
                                }
                            }
                        }
                    });
                    totalPartos += rPartos;
                    totalPrenatal += rPrenatal;

                    regionsHtml += `
                        <div class="row" style="border-left: 4px solid ${getRegionColor(region)}; padding-left: 10px; margin-bottom: 5px;">
                            <span><strong>${region}</strong></span>
                            <span>Unidades: <b>${total}</b> | Partos: <b>${rPartos}</b></span>
                        </div>`;
                }
            });
            regionsHtml += '</div>';

            const features = [];
            geojsonLayer.eachLayer(layer => {
                if (dataMap.has(String(layer.feature.properties.id).substring(0, 6))) features.push(layer.feature);
            });
            const featureCollection = { type: "FeatureCollection", features: features };

            generatePrintWindow('DRS VI Completa', 'Dossiê Geral de Saúde', totalUnidades, totalPartos, totalPrenatal, 
                regionsHtml, generateEquipamentosHtml(equipAgregados), '', featureCollection, '#333');
        };

        // --- HELPER GENÉRICO DE HTML ---
        function generateUnitsHtml(data) {
            let html = '<div class="section">';
            headersUnidades.forEach(h => {
                const val = parseInt(data[h.trim()]);
                if (val > 0 && h !== 'Total' && h !== 'Cod municipio' && h !== 'Municipio') {
                    html += `<div class="row"><span>${h}</span><strong>${val}</strong></div>`;
                }
            });
            html += `</div>`;
            return html;
        }

        function generatePartosHtml(list) {
            let html = '<div class="section"><h3>Partos (2024-2025)</h3>';
            if (list.length > 0) list.forEach(p => html += `<div class="row"><span>${p.tipo} (${p.ano})</span><strong>${p.total}</strong></div>`);
            else html += '<p>Sem dados.</p>';
            return html + '</div>';
        }

        function generatePrenatalHtml(list) {
            let html = '<div class="section"><h3>Pré-Natal Diabetes</h3>';
            if (list.length > 0) list.forEach(p => html += `<div class="row"><span>${p.tipo} (${p.ano})</span><strong>${p.total}</strong></div>`);
            else html += '<p>Sem dados.</p>';
            return html + '</div>';
        }

        // Função Nova para Gerar HTML dos Equipamentos
        function generateEquipamentosHtml(equipObj) {
            let html = '<div class="section" style="page-break-inside: avoid;"><h3>Infraestrutura e Equipamentos</h3>';
            const keys = Object.keys(equipObj).sort((a,b) => equipObj[b] - equipObj[a]); // Ordernar por maior quantidade
            
            if (keys.length > 0) {
                // Usar colunas se tiver muitos itens
                html += '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0 20px;">';
                keys.forEach(key => {
                    html += `<div class="row" style="border-bottom:1px dashed #eee;"><span>${key}</span><strong>${equipObj[key]}</strong></div>`;
                });
                html += '</div>';
            } else {
                html += '<p>Nenhum equipamento registrado na base de dados.</p>';
            }
            return html + '</div>';
        }

        function generatePrintWindow(title, subtitle, valUnidades, valPartos, valPrenatal, content1, content2, content3, content4, feature, color) {
            const printWindow = window.open('', '_blank');
            
            // Lidar com parâmetros opcionais no final (content4 é equipamentos, feature é geojson)
            // Ajuste caso chame com menos argumentos
            let f = feature;
            let c = color;
            if(typeof content4 === 'object' && content4.type === 'FeatureCollection') { f = content4; content4 = ''; }
            if(typeof content4 === 'object' && content4.type === 'Feature') { f = content4; content4 = ''; }
            
            printWindow.document.write(`
                <html>
                <head>
                    <title>${title}</title>
                    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
                    <style>
                        body { font-family: 'Segoe UI', sans-serif; padding: 20px; color: #333; max-width: 900px; margin: 0 auto; }
                        h1 { color: ${c}; border-bottom: 2px solid ${c}; padding-bottom: 10px; margin-top: 0; }
                        h3 { color: #555; margin-top: 20px; border-bottom: 1px solid #ccc; padding-bottom: 5px; page-break-after: avoid; }
                        .header-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
                        #print-map { height: 300px; border: 1px solid #ccc; border-radius: 8px; }
                        .dashboard { display: flex; flex-direction: column; gap: 15px; justify-content: center; }
                        .dash-card { background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 5px solid ${c}; }
                        .dash-card h4 { margin: 0 0 5px 0; color: #666; font-size: 14px; text-transform: uppercase; }
                        .dash-card .value { font-size: 28px; font-weight: bold; color: ${c}; }
                        .section { margin-bottom: 20px; }
                        .row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px dotted #eee; font-size: 13px; }
                        @media print { .print-btn { display: none; } body { padding: 0; max-width: none; } .header-grid { page-break-inside: avoid; } }
                        .print-btn { background: ${c}; color: white; border: none; padding: 10px 20px; cursor: pointer; border-radius: 5px; font-size: 16px; margin-bottom: 20px; }
                    </style>
                </head>
                <body>
                    <button class="print-btn" onclick="window.print()">Imprimir Agora</button>
                    <h1>${subtitle}: ${title}</h1>
                    <div class="header-grid">
                        <div id="print-map"></div>
                        <div class="dashboard">
                            <h3>Resumo Executivo</h3>
                            <div class="dash-card"><h4>Total de Unidades</h4><div class="value">${valUnidades}</div></div>
                            <div class="dash-card" style="border-left-color: #00a8cc"><h4>Total Partos</h4><div class="value" style="color: #00a8cc">${valPartos}</div></div>
                            <div class="dash-card" style="border-left-color: #ff4757"><h4>Total Pré-Natal</h4><div class="value" style="color: #ff4757">${valPrenatal}</div></div>
                        </div>
                    </div>
                    ${content1} ${content2} ${content3} ${typeof content4 === 'string' ? content4 : ''}
                    <div style="margin-top: 50px; font-size: 12px; color: #999; text-align: center;">Gerado pelo Sistema Inteligente SUS DRS VI</div>
                    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"><\/script>
                    <script>
                        const map = L.map('print-map', { zoomControl: false, attributionControl: false });
                        L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);
                        const feature = ${JSON.stringify(f)};
                        if (feature) {
                            const layer = L.geoJson(feature, { style: { fillColor: '${c}', weight: 2, color: 'black', fillOpacity: 0.4 } }).addTo(map);
                            map.fitBounds(layer.getBounds(), { padding: [20, 20] });
                        }
                    <\/script>
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        const GEOJSON_URL = 'https://raw.githubusercontent.com/tbrugz/geodata-br/master/geojson/geojs-35-mun.json';

        fetch(GEOJSON_URL)
            .then(r => r.json())
            .then(data => {
                document.getElementById('loading').style.display = 'none';
                geojsonLayer = L.geoJson(data, {
                    style: style,
                    onEachFeature: onEachFeature,
                    filter: function(feature) {
                        const ibge = String(feature.properties.id).substring(0, 6);
                        return dataMap.has(ibge);
                    }
                }).addTo(map);
                map.fitBounds(geojsonLayer.getBounds());
            })
            .catch(e => {
                document.getElementById('loading').innerHTML = 'Erro ao carregar mapa.';
                console.error(e);
            });
    </script>
</body>
</html>
